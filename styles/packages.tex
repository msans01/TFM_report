% This works both with inline lists and with macros containing lists
\newcommand*{\GetListMember}[2]{%
    \edef\dotheloop{%
    \noexpand\foreach \noexpand\a [count=\noexpand\i] in {#1} {%
        \noexpand\IfEq{\noexpand\i}{#2}{\noexpand\a\noexpand\breakforeach}{}%
    }}%
    \dotheloop
    \par%
}%

% https://tex.stackexchange.com/questions/184005/adding-arrows-to-a-gantt-chart
% GanttHeader setups some parameters for the rest of the diagram
% #1 Width of the diagram
% #2 Width of the space reserved for task numbers
% #3 Width of the space reserved for task names
% #4 Number of months in the diagram
% #5 Initial month number
% In addition to these parameters, the layout of the diagram is influenced
% by keys defined below, such as y, which changes the vertical scale

\def\GanttHeader#1#2#3#4#5#6{%
 \pgfmathparse{(#1-#2-#3)/#4}
 \tikzset{y=7mm, task number/.style={left, font=\bfseries},
     task description/.style={text width=#3,  right, draw=none,
           % font=\sffamily, xshift=#2,
           xshift=#2,
           minimum height=2em},
     gantt bar/.style={draw=black, fill=blue!30},
     help lines/.style={draw=black!50, dashed},
     x=\pgfmathresult pt
     }
  \def\totalmonths{#4}
  \def\monthsname{Jan,Feb,Mar,Apr,May,Jun}
  \node (Header) [task description] at (0,0) {\textbf{\large Tasks}};


  \node at (6.25,1) {\textbf{\large 2023}};
  \draw (3,0.4) -- (9.5,0.4);
  \draw (3,1.6) -- (9.5,1.6);

  \begin{scope}[shift=($(Header.south east)$)]
	  % \node[above] at (\x,1) {\Large{\y}};
        \foreach \x in {1,...,#6}
	  \node[above, anchor=north] at (\x - 1,0.85) {\GetListMember{\monthsname}{\x}};
 \end{scope}
}

\newcommand\Task[5]{
	\Taskk{#1}{#2}{#3}{#4}{blue}{#5}
}

\def\Taskk#1#2#3#4#5#6{%
\node[task number] at ($(Header.west) + (0, -#1)$) {\normalfont#6};
\node[task description] at (0,-#1) {#2};
\begin{scope}[shift=($(Header.south east)$)]
  \draw (0,-#1) rectangle +(\totalmonths, 1);
  \foreach \x in {1,...,\totalmonths}
    \draw[help lines] (\x,-#1) -- +(0,1);
  \filldraw[gantt bar, fill=#5!30] ($(#3, -#1+0.2)$) rectangle +(#4,0.6);
\end{scope}
}

\def\Range#1#2#3#4#5#6{%
\node[task number] at ($(Header.west) + (0, -#1)$) {#6};
\node[task description] at (0,-#1) {\bfseries#2};
\begin{scope}[shift=($(Header.south east)$)]
  \draw (0,-#1) rectangle +(\totalmonths, 1);
  \foreach \x in {1,...,\totalmonths}
    \draw[help lines] (\x,-#1) -- +(0,1);
  \filldraw[gantt bar, fill=#5!30] ($(#3, -#1+0.4)$) rectangle +(#4,0.2);
\end{scope}
}




